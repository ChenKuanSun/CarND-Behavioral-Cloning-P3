Using TensorFlow backend.
Loading Data: data
Process image
Loading Data: data_crush
Process image
Loading Data: data_fix
Process image
Loading Data: data_smooth2
Process image
Loading Data: data_smoothing
Process image
Loading Data: data_smooth3
Process image
Dataset complete.
2018-11-26 18:17:58.868460: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2
2018-11-26 18:17:59.149829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties:
name: GeForce GTX 1070 major: 6 minor: 1 memoryClockRate(GHz): 1.645
pciBusID: 0000:01:00.0
totalMemory: 8.00GiB freeMemory: 6.62GiB
2018-11-26 18:17:59.161732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-11-26 18:18:00.669357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-26 18:18:00.675419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0
2018-11-26 18:18:00.680748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N
2018-11-26 18:18:00.686951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6381 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:01:00.0, compute capability: 6.1)
Create model
model.py:34: UserWarning: Update your `Conv2D` call to the Keras 2 API: `Conv2D(24, (5, 5), activation="relu", strides=(2, 2))`
  model.add(Conv2D(24, 5,5,subsample=(2,2), activation='relu'))
model.py:35: UserWarning: Update your `Conv2D` call to the Keras 2 API: `Conv2D(36, (5, 5), activation="relu", strides=(2, 2))`
  model.add(Conv2D(36, 5,5,subsample=(2,2), activation='relu'))
model.py:36: UserWarning: Update your `Conv2D` call to the Keras 2 API: `Conv2D(48, (5, 5), activation="relu", strides=(2, 2))`
  model.add(Conv2D(48, 5,5,subsample=(2,2), activation='relu'))
model.py:37: UserWarning: Update your `Conv2D` call to the Keras 2 API: `Conv2D(64, (3, 3), activation="relu")`
  model.add(Conv2D(64, 3,3, activation='relu'))
model.py:39: UserWarning: Update your `Conv2D` call to the Keras 2 API: `Conv2D(64, (3, 3), activation="relu")`
  model.add(Conv2D(64, 3,3, activation='relu'))
Train on 51567 samples, validate on 22101 samples
Epoch 1/10
2018-11-26 18:18:02.540943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-11-26 18:18:02.545287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-26 18:18:02.552094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0
2018-11-26 18:18:02.556596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N
2018-11-26 18:18:02.560268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6381 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:01:00.0, compute capability: 6.1)
51567/51567 [==============================] - 52s 1ms/step - loss: 0.1178 - val_loss: 0.0352
Epoch 2/10
51567/51567 [==============================] - 45s 877us/step - loss: 0.1052 - val_loss: 0.0308
Epoch 3/10
51567/51567 [==============================] - 45s 864us/step - loss: 0.0991 - val_loss: 0.0324
Epoch 4/10
51567/51567 [==============================] - 45s 872us/step - loss: 0.0966 - val_loss: 0.0370
Epoch 5/10
51567/51567 [==============================] - 45s 877us/step - loss: 0.0933 - val_loss: 0.0293
Epoch 6/10
51567/51567 [==============================] - 46s 887us/step - loss: 0.0901 - val_loss: 0.0299
Epoch 7/10
51567/51567 [==============================] - 44s 862us/step - loss: 0.0896 - val_loss: 0.0340
Epoch 8/10
51567/51567 [==============================] - 45s 864us/step - loss: 0.0860 - val_loss: 0.0364
Epoch 9/10
51567/51567 [==============================] - 45s 874us/step - loss: 0.0846 - val_loss: 0.0326
Epoch 10/10
51567/51567 [==============================] - 46s 884us/step - loss: 0.0817 - val_loss: 0.0327
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
lambda_1 (Lambda)            (None, 80, 320, 3)        0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 38, 158, 24)       1824
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 17, 77, 36)        21636
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 7, 37, 48)         43248
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 5, 35, 64)         27712
_________________________________________________________________
dropout_1 (Dropout)          (None, 5, 35, 64)         0
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 3, 33, 64)         36928
_________________________________________________________________
flatten_1 (Flatten)          (None, 6336)              0
_________________________________________________________________
dense_1 (Dense)              (None, 100)               633700
_________________________________________________________________
activation_1 (Activation)    (None, 100)               0
_________________________________________________________________
dropout_2 (Dropout)          (None, 100)               0
_________________________________________________________________
dense_2 (Dense)              (None, 50)                5050
_________________________________________________________________
dense_3 (Dense)              (None, 10)                510
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 11
=================================================================
Total params: 770,619
Trainable params: 770,619
Non-trainable params: 0